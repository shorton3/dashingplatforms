<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>DashingPlatforms: DataManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DashingPlatforms
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classDataManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DataManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="DataManager_8h_source.html">DataManager.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a291f3b4df4392598b2d7064da062705f"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a291f3b4df4392598b2d7064da062705f">~DataManager</a> ()</td></tr>
<tr class="separator:a291f3b4df4392598b2d7064da062705f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0ba01f5300cdbe6ff1b347eb32d78c2b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a0ba01f5300cdbe6ff1b347eb32d78c2b">initialize</a> (string configurationFileLocation)</td></tr>
<tr class="separator:a0ba01f5300cdbe6ff1b347eb32d78c2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c829d2c98f72e26edeae47bc777b4ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a6c829d2c98f72e26edeae47bc777b4ad">activateConnectionSet</a> (string connectionSetName)</td></tr>
<tr class="separator:a6c829d2c98f72e26edeae47bc777b4ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cee756be321b4450c925af620d52eaa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a1cee756be321b4450c925af620d52eaa">deActivateConnectionSet</a> (string connectionSetName)</td></tr>
<tr class="separator:a1cee756be321b4450c925af620d52eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a805386d5936b55c4f4df1879f04a6e4a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a805386d5936b55c4f4df1879f04a6e4a">deActivateAllConnectionSets</a> ()</td></tr>
<tr class="separator:a805386d5936b55c4f4df1879f04a6e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a686c287dbe16fad94f62abc5834281ee"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a686c287dbe16fad94f62abc5834281ee">reserveConnection</a> (string connectionSetName)</td></tr>
<tr class="separator:a686c287dbe16fad94f62abc5834281ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43582d1b3a7f53bb5c1077d8b2e4900"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#af43582d1b3a7f53bb5c1077d8b2e4900">reserveConnectionNonBlocking</a> (string connectionSetName)</td></tr>
<tr class="separator:af43582d1b3a7f53bb5c1077d8b2e4900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea951bb2bb1db77965f7625549d9ab2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataManager.html#a0ea951bb2bb1db77965f7625549d9ab2">releaseConnection</a> (<a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a> *connectionHandle)</td></tr>
<tr class="separator:a0ea951bb2bb1db77965f7625549d9ab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classDataManager.html">DataManager</a> provides an application interface for setting and retrieving data to and from the persistent store. </p>
<p><a class="el" href="classDataManager.html">DataManager</a> is provided to hide some of the complexity of working with the database. It is intended to allow the database to be transparently replaced by different products/mechanisms without requiring the applications to do major surgery. Additionally, the <a class="el" href="classDataManager.html">DataManager</a> defines the concurrency model for how the applications will interact with the database. For example, an application program will have multiple threads; each thread requires periodic access to the database. A connection set will be created for this application that contains FEWER connections than the number of threads that need them. Each thread is required to reserve a database connection, use it, and then release it back into the <a class="el" href="classDataManager.html">DataManager</a> pool so that another thread can then reserve and access. Of course the number of pooled connections versus the number of application threads is a systems engineering exercise and is configurable. Note that each connection is itself NOT thread safe and multiple threads should not attempt to access the same connection object (<a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a>) after it has been reserved by a single thread (this is typically the concurrency architecture for most database drivers). (This is possible with additional mutex/concurrency mechanisms implemented by the application, but it is NOT ADVISABLE, and not necessary). </p>
<p>The general error handling strategy for the application developer should be as follows. If any errors are encountered while issuing query/update/insert/delete commands or while analyzing results, the developer should release the connection back into the pool and attempt to reserve another connection for use. The release process includes a health check on the connection that will attempt to re-establish/ renew that connection in the event of a failure. </p>
<p><a class="el" href="classDataManager.html">DataManager</a> exists as a library for each of the application processes to use for managing its database connections. <a class="el" href="classDataManager.html">DataManager</a> supports pooling of connections, and connection re-establishment and retry. Because the <a class="el" href="classDataManager.html">DataManager</a> is a bootstrap requirement for the applications obtaining all of their other configuration information (from the database), the <a class="el" href="classDataManager.html">DataManager</a> reads ITS configuration from a file. Furthermore, because <a class="el" href="classDataManager.html">DataManager</a> is used by multiple processes, this file must contain process-specific configuration sections to meet each process's unique database connection requirements (with regards to the number of connections, both local and remote, etc.) </p>
<p>The format of the <a class="el" href="classDataManager.html">DataManager</a> configuration file is: </p><pre>
  [Configuration]
  DEBUGLEVEL=5
  <br />
<br />

  [<a class="el" href="classConnectionSet.html">ConnectionSet</a> Name]
  # Some comments
  # Perhaps some more comments
  USERID=userid
  PASSWORD=password (NOTE: This will need to be encrypted later...suggest MD5)
  DRIVERNAME=libpq
  CONNECTIONTYPE=LOCAL (or REMOTE)
  CONNECTIONSTRING="hostaddr=127.0.0.1 port=3180"
  NUMBERCONNECTIONS=1
  DSN=someDSN
  <br />
<br />

  [Next <a class="el" href="classConnectionSet.html">ConnectionSet</a> Name]
  ...
</pre> <p>The above [Configuration] section exists in order to set DataManager-wide configuration parameters. Each subsequent [<a class="el" href="classConnectionSet.html">ConnectionSet</a> Name] section establishes the configuration for a pool of connections. Note that an <a class="el" href="classOPM.html">OPM</a> object pool is created even if only 1 connection is indicated. An application process can have multiple [<a class="el" href="classConnectionSet.html">ConnectionSet</a>] sections for its use in the configuration file. The application process would then call <a class="el" href="classDataManager.html#a6c829d2c98f72e26edeae47bc777b4ad">DataManager::activateConnectionSet(string connectionSetName)</a> for each configured connection set that it needs to use. </p>
<dl class="section rcs"><dt>Author</dt><dd>Stephen Horton</dd></dl>
<dl class="section rcs"><dt>Revision</dt><dd>1</dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a291f3b4df4392598b2d7064da062705f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataManager::~DataManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Virtual Destructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a6c829d2c98f72e26edeae47bc777b4ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int DataManager::activateConnectionSet </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>connectionSetName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Application processes will call this method for each <a class="el" href="classConnectionSet.html">ConnectionSet</a> in the configuration file that they need to use. This method will create the database connection pools. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionSetName</td><td>must match a name in the configuration file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR for database connection failures; otherwise OK </dd></dl>

<p>Referenced by <a class="el" href="classResourceMonitor.html#a64f01887447b742b08184891ca06e5c2">ResourceMonitor::initialize()</a>, and <a class="el" href="classFaultManager.html#a801cf6c046d9cebae73229a3378bcee1">FaultManager::initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a805386d5936b55c4f4df1879f04a6e4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int DataManager::deActivateAllConnectionSets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method for performing deActivation of All Connection Sets within this application process. All connections to the database are closed. </p><dl class="section return"><dt>Returns</dt><dd>ERROR for database connection shutdown failures; otherwise OK </dd></dl>

</div>
</div>
<a class="anchor" id="a1cee756be321b4450c925af620d52eaa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int DataManager::deActivateConnectionSet </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>connectionSetName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method for performing deActivation of the Connection Set. All connections to the database are closed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionSetName</td><td>must match a name in the configuration file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR for database connection shutdown failures; otherwise OK </dd></dl>

</div>
</div>
<a class="anchor" id="a0ba01f5300cdbe6ff1b347eb32d78c2b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int DataManager::initialize </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>configurationFileLocation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the <a class="el" href="classDataManager.html">DataManager</a> with the location of the configuration file. </p>
<p>Open and parse the entire configuration file. This creates a <a class="el" href="classConnectionSet.html">ConnectionSet</a> object for each section in the file. </p><dl class="section return"><dt>Returns</dt><dd>ERROR for File IO or File format parsing errors; otherwise OK </dd></dl>

<p>References <a class="el" href="classConnectionSet.html#abc08544f0395b1a35367872ca276b1d8">ConnectionSet::setConnectionString()</a>, <a class="el" href="classConnectionSet.html#ad5533cf5215822c5d2d6bf5cc80f4f7a">ConnectionSet::setConnectionType()</a>, <a class="el" href="classConnectionSet.html#ab07115ff4da734387c98974c0dc095e9">ConnectionSet::setDriverName()</a>, <a class="el" href="classConnectionSet.html#a53b247274eda7c0297976fa254c5c54b">ConnectionSet::setDSN()</a>, <a class="el" href="classConnectionSet.html#a5350522197adf3e40b5f722d93099666">ConnectionSet::setNumberConnections()</a>, <a class="el" href="classConnectionSet.html#a55fbfb95bcc0591ed161acf90d8d29ff">ConnectionSet::setPassword()</a>, and <a class="el" href="classConnectionSet.html#a52f6fbfe4741d5bbcf8b9d6846a32d46">ConnectionSet::setUserid()</a>.</p>

<p>Referenced by <a class="el" href="classResourceMonitor.html#a64f01887447b742b08184891ca06e5c2">ResourceMonitor::initialize()</a>, and <a class="el" href="classFaultManager.html#a801cf6c046d9cebae73229a3378bcee1">FaultManager::initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a0ea951bb2bb1db77965f7625549d9ab2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataManager::releaseConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a> *&#160;</td>
          <td class="paramname"><em>connectionHandle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to release the <a class="el" href="classDbConnection.html">DbConnection</a> back into the Connection Set pool. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionHandle</td><td>wraps the connection to be released to the pool </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL if the connectionSetName could not be found </dd></dl>

<p>Referenced by <a class="el" href="classOSResource.html#a3d5a001b4ce6046431d0fa8dfa82786c">OSResource::initialize()</a>, and <a class="el" href="classFaultManager.html#a06321519c488763c07c6bf57be51556e">FaultManager::processMailbox()</a>.</p>

</div>
</div>
<a class="anchor" id="a686c287dbe16fad94f62abc5834281ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a> * DataManager::reserveConnection </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>connectionSetName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to retrieve a pointer to a <a class="el" href="classDbConnection.html">DbConnection</a> from the Connection Set pool. This method blocks until a <a class="el" href="classDbConnection.html">DbConnection</a> becomes available if they are all currently in use. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionSetName</td><td>must match a name in the configuration file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL if the connectionSetName could not be found </dd></dl>

<p>Referenced by <a class="el" href="classOSResource.html#a3d5a001b4ce6046431d0fa8dfa82786c">OSResource::initialize()</a>, and <a class="el" href="classFaultManager.html#a06321519c488763c07c6bf57be51556e">FaultManager::processMailbox()</a>.</p>

</div>
</div>
<a class="anchor" id="af43582d1b3a7f53bb5c1077d8b2e4900"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDbConnectionHandle.html">DbConnectionHandle</a> * DataManager::reserveConnectionNonBlocking </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>connectionSetName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Method to retrieve a pointer to a <a class="el" href="classDbConnection.html">DbConnection</a> from the Connection Set pool. This method does NOT block if there are no DbConnections available in the pool. NOTE that the pools are configured not to GROW and/or SHRINK </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connectionSetName</td><td>must match a name in the configuration file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL if no <a class="el" href="classDbConnection.html">DbConnection</a> available, or if the connectionSetName could not be found </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="DataManager_8h_source.html">DataManager.h</a></li>
<li>DataManager.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
